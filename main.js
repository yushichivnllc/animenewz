function ajax(e,t,i){var n=new XMLHttpRequest;return n.open(e,t),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.setRequestHeader("Content-Type","application/json"),"GET"!=e&&n.setRequestHeader("X-CSRF-TOKEN",_GLOBAL._TOKEN),n.withCredentials=!0,i?n.send(JSON.stringify(i)):n.send(),n}function getElement(e){return document.querySelector(e)}function createElement(e,t,i,n,o){var s=document.createElement(t);if(s.className=i,s.name=e,n||(n={}),o)for(var r=0;r<o.length;r++)s.setAttribute(o[r].name,o[r].value);if(n.innerHTML&&(s.innerHTML=n.innerHTML),n.childrens)for(r=0;r<n.childrens.length;r++){var a=createElement(n.childrens[r].name,n.childrens[r].tag,n.childrens[r].className,n.childrens[r].options,n.childrens[r].properties);s.appendChild(a),s[n.childrens[r].name]=a}return s}function removeElement(e){e.parentNode.removeChild(e)}function isMobile(){var e,t=/iPhone/i,i=/iPod/i,n=/iPad/i,o=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,s=/Android/i,r=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,a=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,l=/IEMobile/i,c=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,d=/BlackBerry/i,h=/BB10/i,g=/Opera Mini/i,u=/(CriOS|Chrome)(?=.*\bMobile\b)/i,m=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,p=/UC.*Browser|UCWEB/i,f=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),b=function(e,t){return e.test(t)},w=function(e){var w=e||navigator.userAgent,v=w.split("[FBAN");if(void 0!==v[1]&&(w=v[0]),this.apple={phone:b(t,w),ipod:b(i,w),tablet:!b(t,w)&&b(n,w),device:b(t,w)||b(i,w)||b(n,w)},this.amazon={phone:b(r,w),tablet:!b(r,w)&&b(a,w),device:b(r,w)||b(a,w)},this.android={phone:b(r,w)||b(o,w),tablet:!b(r,w)&&!b(o,w)&&(b(a,w)||b(s,w)),device:b(r,w)||b(a,w)||b(o,w)||b(s,w)},this.windows={phone:b(l,w),tablet:b(c,w),device:b(l,w)||b(c,w)},this.other={blackberry:b(d,w),blackberry10:b(h,w),opera:b(g,w),firefox:b(m,w),chrome:b(u,w),uc:b(p,w),device:b(d,w)||b(h,w)||b(g,w)||b(m,w)||b(u,w)},this.seven_inch=b(f,w),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this};return(e=new w).Class=w,e}var ismobile=isMobile();function getScrollTop(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}function formatNumber(e){return(new Intl.NumberFormat).format(e)}function getTimeAgo(e){var t=e.substring(0,10);if(ismobile.apple.device){var i=e.split(/[- :]/);e=new Date(i[0],i[1]-1,i[2],i[3],i[4],i[5]),e=new Date(e).getTime()}else e=new Date(e).getTime();var n=((new Date).getTime()-e)/1e3;return n>2592e3?(t=t.split("-"))[2]+"-"+t[1]+"-"+t[0]:n>604800?Math.floor(n/604800)+" tuần trước":n>86400?Math.floor(n/86400)+" ngày trước":n>3600?Math.floor(n/3600)+" giờ trước":n>60?Math.floor(n/60)+" phút trước":Math.floor(n)+" giây trước"}var searchInput=getElement(".navbar-search > input"),searchIcon=getElement(".navbar-search-icon");function search(){searchInput.value.length&&(window.location.href="/tim-kiem/"+slugify(searchInput.value))}function slugify(e){return e.toString().toLowerCase()}searchInput.onkeydown=function(e){13==e.which&&search()},searchIcon.onclick=function(){search()},console.log("home");var LastSectionTop=0,offset=12,limit=10,flag=!1,sections=document.querySelectorAll(".section.container"),sectionTags=document.querySelectorAll(".section.section-tag"),columnRight=getElement(".news-featured"),loadMore=getElement(".column-more"),loadMoreData=getElement(".column-more-data");try{LastSectionTop=sections[sections.length-1].getBoundingClientRect().top;flag=!0}catch(e){}function fixColumnRight(e){if(e){columnRight.classList.add("sidebar-fixed");var t=(document.body.offsetWidth-sections[0].offsetWidth)/2;window.innerWidth<1280&&(t+=5),columnRight.style.right=t+"px"}else columnRight.classList.remove("sidebar-fixed"),columnRight.style.right=""}window.addEventListener("scroll",function(e){window.innerWidth<1024||!flag||((LastSectionTop=sections[sections.length-1].getBoundingClientRect().top)>window.innerHeight?fixColumnRight(!1):(console.log("fixColumnRight"),fixColumnRight(!0),columnRight.style.top=LastSectionTop>80?LastSectionTop+"px":""))}),window.addEventListener("resize",function(e){fixColumnRight(!1)});var itemTagWidth=getItemTagStyle();function getItemTagStyle(){try{var e=getElement(".item-tag"),t=window.getComputedStyle(e)||e.currentStyle,i=parseInt(t.marginRight);return{width:itemTagWidth=e.offsetWidth+i,right:i}}catch(e){return window.innerWidth<1279?{width:252,right:10}:{width:261,right:19}}}function slideSectionTag(e,t,i){e.step=1,t.onclick=function(){itemTagWidth=getItemTagStyle().width;var t=getItemTagStyle().right,n=parseInt(e.style.left)||0,o=e.parentNode.offsetWidth,s=Math.floor(o/itemTagWidth),r=s*itemTagWidth,a=e.children.length%s*itemTagWidth-(o-r)-t,l=Math.floor(e.children.length/s);if("right"!=i){if(console.log("step: "+l),e.step<1)return;e.step>l?(e.step=l,n+=a+r):n+=r,n>0&&(n=0),e.step--,console.log("element step: "+e.step)}else{if(console.log("step: "+l),e.step>l)return;e.step<1&&(e.step=1),e.step<l?n-=r:n-=a,e.step++,console.log("element step: "+e.step)}e.style.left=n+"px"}}for(var i=0;i<sectionTags.length;i++){var content=sectionTags[i].querySelector(".section-tag-content"),leftButton=sectionTags[i].querySelector(".navigation-left"),rightButton=sectionTags[i].querySelector(".navigation-right");content.style.width=parseInt(itemTagWidth)*content.children.length+"px",slideSectionTag(content,leftButton,"left"),slideSectionTag(content,rightButton,"right"),listenWindowResize(content)}function listenWindowResize(e){window.addEventListener("resize",function(){e.step=1,e.style.left="",e.style.width=getItemTagStyle().width*e.children.length+"px"})}loadMore.onclick=function(){this.style.opacity="0.6",this.style.cursor="not-allowed";var e=ajax("GET","/api/news/?offset="+offset+"&limit="+limit);e.onload=function(){if(200==e.status||304==e.status){for(var t=JSON.parse(e.responseText),i=0;i<t.length;i++)t[i],loadMoreData.appendChild(createElement("item","div","item",{childrens:[{name:"thumbnail",tag:"div",className:"item-thumbnail",options:{innerHTML:'<a href="/'+t[i].slug+'"><img src="'+t[i].thumbnail+'" alt="'+t[i].title+'"></a>'}},{name:"meta",tag:"div",className:"item-meta",options:{innerHTML:'<a href="/the-loai/'+t[i].genre.slug+'"><span class="item-genre genre-'+t[i].genre.id+' has-background">'+t[i].genre.name+'</span></a><a href="/'+t[i].slug+'"><h3 class="item-title">'+t[i].title+'</h3></a><span class="item-date">'+getTimeAgo(t[i].published_at)+'</span><span class="item-views">&nbsp;- '+formatNumber(t[i].views)+' lượt xem</span><p class="item-description">'+t[i].description+"</p>"}}]}));offset+=t.length,t.length||loadMore.classList.add("hide")}loadMore.style=""},e.onerror=function(){loadMore.style=""}};
